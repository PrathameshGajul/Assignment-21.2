Q.Explain the different methods of
● mapper class and
● reducer class

Ans:
1)Map method in Mapper:

-map(inKey, inValue) -> list(intermediateKey, intermediateValue)
-The purpose of the map phase is to organize the data in preparation for the processing done in the reduce phase.
-The input to the map function is in the form of key-value pairs, even though the input to a MapReduce program is a file or file(s).By default, the value is a data record and the key is generally the offset of the data record from the beginning of the data file.
-The output consists of a collection of key-value pairs which are input for the reduce function. The content of the key-value pairs depends on the specific implementation.

2)Reduce method in Reducer:

-reduce(intermediateKey, list(intermediateValue)) -> list(outKey, outValue)
-Each reduce function processes the intermediate values for a particular key generated by the map function and generates the output.
-Essentially there exists a one-one mapping between keys and reducers.
-Several reducers can run in parallel, since they are independent of one another.
-The number of reducers is decided by the user. By default, the number of reducers is 1.

3)Hadoop setup and cleanup methods in Mapper and Reducer:

In hadoop Mapreduce program,there are two methods : Hadoop setup Method and hadoop cleanup method.These two methods are used in our mapreduce program based on our requirement. We can write Hadoop setup method and cleanup method in both Mapper and reducer where we require it in our mapreduce code.

Hadoop setup method:

-What typically happens during setup() is that you may read parameters from the configuration object to customize your processing logic.The lifecycle of a map/reduce task is:

setup -> map -> cleanup

setup -> reduce -> cleanup

Here is the main confusion is where exactly use hadoop setup method and hadoop clean up method and which situations we have to use hadoop setup and hadoop cleanup methods in our mapreduce program.In simple words we can write hadoop setup method before Map task or before reducer task.

setup: Called once at the beginning of the task
We can use hadoop setup method if you want to define user defined parameters to your map task or reducer task and you want to compare the words with mapreduce input file and if you want to use hadoop distributed cache in your mapreduce program at that time we will hadoop setup method.

Hadoop cleanup method:

-What typically happens during cleanup() is that you clean up any resources you may have allocated. There are other uses too, which is to flush out any accumulation of aggregate results.

Setup() and cleanup() are the methods that you can override, if you choose, and they are there for you to initialize and clean up your map/reduce tasks. You actually don’t have access to any data from the input split directly during these phases. The lifecycle of a map/reduce task is:

setup -> map -> cleanup

setup -> reduce -> cleanup

So, for each mapreduce first setup() method is called then map()/reduce() method is called and later cleanup() method is called before exiting the task.
